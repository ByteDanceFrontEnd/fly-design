(function(e,a){typeof exports=="object"&&typeof module<"u"?module.exports=a(require("vue")):typeof define=="function"&&define.amd?define(["vue"],a):(e=typeof globalThis<"u"?globalThis:e||self,e.index=a(e.Vue))})(this,function(e){"use strict";const a="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjc1ODY4MDc0MjA0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3OTMiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTIwMi42NjY2NjcgMjU2aC00Mi42NjY2NjdhMzIgMzIgMCAwIDEgMC02NGg3MDRhMzIgMzIgMCAwIDEgMCA2NEgyNjYuNjY2NjY3djU2NS4zMzMzMzNhNTMuMzMzMzMzIDUzLjMzMzMzMyAwIDAgMCA1My4zMzMzMzMgNTMuMzMzMzM0aDM4NGE1My4zMzMzMzMgNTMuMzMzMzMzIDAgMCAwIDUzLjMzMzMzMy01My4zMzMzMzRWMzUyYTMyIDMyIDAgMCAxIDY0IDB2NDY5LjMzMzMzM2MwIDY0LjgtNTIuNTMzMzMzIDExNy4zMzMzMzMtMTE3LjMzMzMzMyAxMTcuMzMzMzM0SDMyMGMtNjQuOCAwLTExNy4zMzMzMzMtNTIuNTMzMzMzLTExNy4zMzMzMzMtMTE3LjMzMzMzNFYyNTZ6IG0yMjQtMTA2LjY2NjY2N2EzMiAzMiAwIDAgMSAwLTY0aDE3MC42NjY2NjZhMzIgMzIgMCAwIDEgMCA2NEg0MjYuNjY2NjY3eiBtLTMyIDI4OGEzMiAzMiAwIDAgMSA2NCAwdjI1NmEzMiAzMiAwIDAgMS02NCAwVjQzNy4zMzMzMzN6IG0xNzAuNjY2NjY2IDBhMzIgMzIgMCAwIDEgNjQgMHYyNTZhMzIgMzIgMCAwIDEtNjQgMFY0MzcuMzMzMzMzeiIgZmlsbD0iIzEyOTZkYiIgcC1pZD0iMzc5NCI+PC9wYXRoPjwvc3ZnPg==",L="",g={class:"fly-uploader-imagelist"},N={class:"preview-images-list"},p=["src"],m={class:"preview-delete-icon"},y=["onClick"],j={__name:"Upload",props:{accept:{type:String},size:{type:Number},limit:{type:Number},onSuccess:{type:Function},onError:{type:Function}},setup(s){const f=s;let o=e.ref([]);function d(t,M){e.reactive({click:()=>{document.getElementById("file-input").click()},change:n=>{o.value.push(n.target.files)},drop:n=>{n.preventDefault(),o.value.push(n.dataTransfer.files)}})[M](t)}function I(t){t.preventDefault()}function D(t){window.URL&&window.URL.createObjectURL?A(t):E(t)}let c=e.ref([]);function A(t){let M=t.map(l=>({file:l,url:URL.createObjectURL(new Blob(l))}));c.value=M}function E(t){const M=function(n){return new Promise((i,z)=>{let r=new FileReader;r.readAsDataURL(n),r.onload=u=>{i(u.target.result)},r.onerror=u=>{z("文件读取失败"+u)}})};let l=t.map(M);Promise.all(l).then(n=>{c.value=n.map((i,z)=>({url:i,file:t[z]}))})}function w(t){c.value.splice(t,1),o.value.splice(t,1)}return e.watch(o.value,t=>{let M=Array.from(t);const{size:l,accept:n,onError:i,limit:z}=e.toRefs(f);if(!(M.length<=0)){if(M.some(r=>r[0].size>l.value))return i.value(`文件最大上传${l.value}k`);if(M.some(r=>!n.value.split(" ").indexOf(r[0].type)))return i.value(`只接受${n.value}类型的文件`);if(o.value.length>z.value)return o.value.pop(),i.value(`最多上传${z.value}个图片`);D(M)}}),(t,M)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{class:"fly-uplouder-wrapper",onDrop:M[2]||(M[2]=l=>d(l,"drop")),onDragover:I,onDragenter:I},[e.createElementVNode("div",g,[e.createElementVNode("div",{class:"fly-uploader-container",onClick:M[1]||(M[1]=l=>d(l,"click"))},[e.renderSlot(t.$slots,"uploader-area"),e.createElementVNode("input",{id:"file-input",type:"file",class:"fly-file__invisible",ref:"file",onChange:M[0]||(M[0]=l=>d(l,"change"))},null,544)])]),e.createElementVNode("div",null,[e.renderSlot(t.$slots,"tip")])],32),e.createElementVNode("ul",N,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(l,n)=>(e.openBlock(),e.createElementBlock("li",{key:n},[e.createElementVNode("img",{src:l.url,alt:""},null,8,p),e.createElementVNode("span",m,[e.createElementVNode("img",{src:a,onClick:i=>w(n)},null,8,y)])]))),128))])],64))}};return{install(s){s.component("Upload",j)}}});
